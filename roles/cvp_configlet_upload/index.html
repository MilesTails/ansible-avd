<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Arista Ansible Team">
    <link rel="shortcut icon" href="../../docs/_media/favicon.ico">
    <title>cvp_configlet_upload &mdash; Arista AVD collection</title>
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/tonsky/FiraCode@1.206/distr/fira_code.css">
    <link rel="stylesheet" href="//use.fontawesome.com/releases/v5.8.1/css/all.css">
    <link rel="stylesheet" href="//use.fontawesome.com/releases/v5.8.1/css/v4-shims.css">
    <link rel="stylesheet" href="../../css/theme.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
    <link rel="stylesheet" href="../../docs/stylesheets/extra.ivory.css">
    <script src="//code.jquery.com/jquery-2.1.1.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script>
        hljs.initHighlightingOnLoad();
    </script> 
</head>

<body ontouchstart="">
    <div id="container">
        <aside>
            <div class="home">
                <div class="title">
                    <button class="hamburger"></button>
                    <a href="../.." class="site-name"> Arista AVD collection</a>
                </div>
                <div class="search">
                    <div role="search">
    <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
        <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
    </form>
</div>
                </div>
            </div>
            <nav class="nav">
                <ul class="root">
                    <li class="toctree-l1"><a class="nav-item" href="../..">Home</a></li>
                    <li class="toctree-l1"><button class="section nav-item">Installation</button>
<ul class="subnav">
    <li class="toctree-l2"><a class="nav-item" href="../../docs/installation/requirements/">Requirements</a></li>
    <li class="toctree-l2"><a class="nav-item" href="../../docs/installation/setup-environement/">Setup environment</a></li>
    <li class="toctree-l2"><a class="nav-item" href="../../docs/installation/setup-galaxy/">Ansible-galaxy installation</a></li>
    <li class="toctree-l2"><a class="nav-item" href="../../docs/installation/setup-git/">Git installation</a></li>
    <li class="toctree-l2"><a class="nav-item" href="../../docs/installation/development/">Configure development environment</a></li>
</ul></li>
                    <li class="toctree-l1"><a class="nav-item" href="../../docs/getting-started/">Getting Started</a></li>
                    <li class="toctree-l1"><button class="section nav-item">How-To</button>
<ul class="subnav">
    <li class="toctree-l2"><a class="nav-item" href="../../docs/how-to/first-project/">Build your first AVD project</a></li>
</ul></li>
                    <li class="toctree-l1"><button class="section nav-item">Roles documentation</button>
<ul class="subnav">
    <li class="toctree-l2"><a class="nav-item" href="../eos_l3ls_evpn/">eos_l3ls_evpn</a></li>
    <li class="toctree-l2"><a class="nav-item" href="../eos_cli_config_gen/">eos_cli_config_gen</a></li>
    <li class="toctree-l2 current"><a class="nav-item current" href="./">cvp_configlet_upload</a>
<ul class="subnav">
<li class="toctree-l3"><a class="nav-item toc" href="#overview">Overview</a></li>
<li class="toctree-l3"><a class="nav-item toc" href="#role-requirements">Role requirements</a></li>
<li class="toctree-l3"><a class="nav-item toc" href="#role-inputs-and-outputs">Role Inputs and Outputs</a></li>
<li class="toctree-l3"><a class="nav-item toc" href="#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="nav-item toc" href="#license">License</a></li>
</ul></li>
    <li class="toctree-l2"><a class="nav-item" href="../eos_config_deploy_cvp/">eos_config_deploy_cvp</a></li>
    <li class="toctree-l2"><a class="nav-item" href="../eos_config_deploy_eapi/">eos_config_deploy_eapi</a></li>
    <li class="toctree-l2"><a class="nav-item" href="../eos_validate_state/">eos_validate_state</a></li>
    <li class="toctree-l2"><a class="nav-item" href="../build_output_folders/">build_output_folders</a></li>
</ul></li>
                    <li class="toctree-l1"><button class="section nav-item">Modules documentation</button>
<ul class="subnav">
    <li class="toctree-l2"><a class="nav-item" href="../../docs/modules/inventory_to_container.rst/">Module Inventory to containers</a></li>
    <li class="toctree-l2"><a class="nav-item" href="../../docs/modules/configlet_build_config.rst/">Module Configlet Build configuration</a></li>
</ul></li>
                    <li class="toctree-l1"><button class="section nav-item">External resources</button>
<ul class="subnav">
    <li class="toctree-l2">
<a class="nav-item" href="https://docs.ansible.com/ansible/latest/user_guide/collections_using.html">Ansible collection user guide</a></li>
    <li class="toctree-l2">
<a class="nav-item" href="https://docs.ansible.com/ansible/latest/user_guide/index.html">Ansible User guide</a></li>
</ul></li>
                    <li class="toctree-l1"><button class="section nav-item">About</button>
<ul class="subnav">
    <li class="toctree-l2"><a class="nav-item" href="../../docs/contributing/">Contribution Guide</a></li>
    <li class="toctree-l2">
<a class="nav-item" href="https://galaxy.ansible.com/arista/cvp">Ansible Galaxy page</a></li>
    <li class="toctree-l2">
<a class="nav-item" href="https://github.com/aristanetworks/ansible-cvp">Arista CloudVision Modules</a></li>
    <li class="toctree-l2">
<a class="nav-item" href="https://github.com/aristanetworks/netdevops-examples">Arista Automation Examples</a></li>
</ul></li>
                </ul>
            </nav>
            <div class="repo">
    <div class="link">
    </div>
    <div class="previous"><a href="../eos_cli_config_gen/">&laquo; Previous</a></div>
    <div class="next"><a href="../eos_config_deploy_cvp/">Next &raquo;</a></div>
</div>
        </aside>
        <div id="spacer"><button class="arrow"></button></div>
        <main>
            <div class="home-top">
                <button class="hamburger"></button>
                <a href="../.." class="site-name"> Arista AVD collection</a>
            </div>
            <div id="main">
                <nav class="breadcrumbs">
<ul>
    <li>Roles documentation</li>
</ul>
</nav>
                <div id="content"><h1 id="ansible-role-cvp_configlet_upload">Ansible Role: cvp_configlet_upload<a class="headerlink" href="#ansible-role-cvp_configlet_upload" title="Permanent link">#</a></h1>
<p><strong>Table of Contents:</strong></p>
<ul>
<li><a href="#ansible-role-cvp_configlet_upload">Ansible Role: cvp_configlet_upload</a></li>
<li><a href="#overview">Overview</a></li>
<li><a href="#role-requirements">Role requirements</a></li>
<li><a href="#role-inputs-and-outputs">Role Inputs and Outputs</a></li>
<li><a href="#requirements">Requirements</a></li>
<li><a href="#license">License</a></li>
</ul>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">#</a></h2>
<p><strong>cvp_configlet_upload</strong>, is a role that deploys configlets stored in a local folder to Cloudvision server.</p>
<h2 id="role-requirements">Role requirements<a class="headerlink" href="#role-requirements" title="Permanent link">#</a></h2>
<p>This role requires to install <code>arista.cvp</code> collection to support CloudVision interactions.</p>
<div class="highlight"><pre><span></span><code>$ ansible-galaxy collection install arista.cvp
</code></pre></div>

<h2 id="role-inputs-and-outputs">Role Inputs and Outputs<a class="headerlink" href="#role-inputs-and-outputs" title="Permanent link">#</a></h2>
<ol>
<li>Read content of <code>{{configlet_directory}}</code> and create <strong>cv_configlet</strong> input structure.</li>
<li>Collect Cloudvision facts.</li>
<li>Create or update configlets on Cloudvision server with content from <code>{{configlet_directory}}</code></li>
</ol>
<p><strong>Inputs:</strong></p>
<p><strong>Inventory configuration:</strong></p>
<p>An entry must be part of the inventory to describe CloudVision server. <code>arista.cvp</code> modules use httpapi approach. Example below provides framework to use in your inventory.</p>
<div class="highlight"><pre><span></span><code><span class="nt">all</span><span class="p">:</span>
  <span class="nt">children</span><span class="p">:</span>
    <span class="nt">cloudvision</span><span class="p">:</span>
      <span class="nt">hosts</span><span class="p">:</span>
        <span class="nt">cv_server01</span><span class="p">:</span>
          <span class="nt">ansible_httpapi_host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10.83.28.164</span>
          <span class="nt">ansible_host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10.83.28.164</span>
          <span class="nt">ansible_user</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ansible</span>
          <span class="nt">ansible_password</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ansible</span>
          <span class="nt">ansible_connection</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">httpapi</span>
          <span class="nt">ansible_httpapi_use_ssl</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
          <span class="nt">ansible_httpapi_validate_certs</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">False</span>
          <span class="nt">ansible_network_os</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">eos</span>
          <span class="nt">ansible_httpapi_port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">443</span>
          <span class="c1"># Configuration to get Virtual Env information</span>
          <span class="nt">ansible_python_interpreter</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">$(which python3)</span>
</code></pre></div>

<p><strong>Module variables:</strong></p>
<ul>
<li><strong><code>configlet_directory</code></strong>: Folder where local configlets are stored. Default: <code>configlets</code>.</li>
<li><strong><code>file_extension</code></strong>: File extension to look for configlet in their local folder. Default: <code>conf</code>.</li>
<li><strong><code>configlets_cvp_prefix</code></strong>: Prefix to use for configlet on CV side. Default: <em>Not set</em> and it is required.</li>
</ul>
<p><em>Example</em>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">tasks</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">upload cvp configlets</span>
    <span class="nt">import_role</span><span class="p">:</span>
        <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">arista.avd.cvp_configlet_upload</span>
    <span class="nt">vars</span><span class="p">:</span>
      <span class="nt">configlet_directory</span><span class="p">:</span> <span class="s">&#39;configlets/&#39;</span>
      <span class="nt">file_extension</span><span class="p">:</span> <span class="s">&#39;txt&#39;</span>
      <span class="nt">configlets_cvp_prefix</span><span class="p">:</span> <span class="s">&#39;DC1-AVD&#39;</span>
</code></pre></div>

<p>This module also supports tags to run a subset of ansible tasks:</p>
<ul>
<li><strong><code>build</code></strong>: Generate <code>cv_configlet</code> input structure.</li>
<li><strong><code>provision</code></strong>: Run <code>build</code> tags + configure Cloudvision with information generated in previous tasks</li>
</ul>
<div class="highlight"><pre><span></span><code>$ ansible-playbook playbook.to.deploy.with.cvp.yml --tags <span class="s2">&quot;provision&quot;</span>
</code></pre></div>

<p><strong>Outputs:</strong></p>
<ul>
<li>None.</li>
</ul>
<p><strong>Tasks:</strong></p>
<ol>
<li>Read content of <code>{{configlet_directory}}</code> and create <strong>cv_configlet</strong> input structure.</li>
<li>Collect Cloudvision facts.</li>
<li>Create or update configlets on Cloudvision server with content from <code>{{configlet_directory}}</code></li>
</ol>
<h2 id="requirements">Requirements<a class="headerlink" href="#requirements" title="Permanent link">#</a></h2>
<p>Requirements are located here: <a href="../..#Requirements">avd-requirements</a></p>
<h2 id="license">License<a class="headerlink" href="#license" title="Permanent link">#</a></h2>
<p>Project is published under <a href="../../LICENSE">Apache 2.0 License</a></p></div>
                <footer>
    <div class="footer-buttons">
        <div class="previous"><a href="../eos_cli_config_gen/" title="eos_cli_config_gen"><span>Previous</span></a></div>
        <div class="next"><a href="../eos_config_deploy_cvp/" title="eos_config_deploy_cvp"><span>Next</span></a></div>
    </div>
    <div class="footer-note">
        <p>
            Built with <a href="http://www.mkdocs.org">MkDocs</a> using
            <a href="https://github.com/daizutabi/mkdocs-ivory">Ivory theme</a>.
        </p>
    </div>
</footer>
            </div>
        </main>
    </div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js"></script>
    <script src="../../search/main.js"></script>
</body>

</html>